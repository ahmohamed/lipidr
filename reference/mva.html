<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform multivariate analyses to investigate sample clustering — mva • lipidr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Perform multivariate analyses to investigate sample clustering — mva" />
<meta property="og:description" content="mva performs multivariate analysis using several possible methods.
The available methods are PCA, PCoA, OPLS and OPLS-DA. The OPLS method
requires a numeric y-variable, whilst OPLS-DA requires two groups for
comparison. By default, for OPLS and OPLS-DA the number of predictive and
orthogonal components are set to 1.
Blank samples are automatically detected (using TIC) and excluded.
Missing data are imputed using average lipid intensity across all samples." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lipidr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/workflow.html">Effect of diet on serum lipids in mice (Targeted lipidomics)</a>
    </li>
    <li>
      <a href="../articles/examples/mw_integration.html">Data mining from Matabolomics Workbench (Breast cancer dataset)</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ahmohamed/lipidr">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform multivariate analyses to investigate sample clustering</h1>
    <small class="dont-index">Source: <a href='https://github.com/ahmohamed/lipidr/blob/master/R/mva.R'><code>R/mva.R</code></a></small>
    <div class="hidden name"><code>mva.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>mva</code> performs multivariate analysis using several possible methods.
The available methods are PCA, PCoA, OPLS and OPLS-DA. The OPLS method
requires a numeric y-variable, whilst OPLS-DA requires two groups for
comparison. By default, for OPLS and OPLS-DA the number of predictive and
orthogonal components are set to 1.
Blank samples are automatically detected (using TIC) and excluded.
Missing data are imputed using average lipid intensity across all samples.</p>
    </div>

    <pre class="usage"><span class='fu'>mva</span><span class='op'>(</span>
  <span class='va'>data</span>,
  measure <span class='op'>=</span> <span class='st'>"Area"</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"PCA"</span>, <span class='st'>"PCoA"</span>, <span class='st'>"OPLS"</span>, <span class='st'>"OPLS-DA"</span><span class='op'>)</span>,
  group_col <span class='op'>=</span> <span class='cn'>NULL</span>,
  groups <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>plot_mva</span><span class='op'>(</span>
  <span class='va'>mvaresults</span>,
  components <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>,
  color_by <span class='op'>=</span> <span class='cn'>NULL</span>,
  ellipse <span class='op'>=</span> <span class='cn'>TRUE</span>,
  hotelling <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>plot_mva_loadings</span><span class='op'>(</span>
  <span class='va'>mvaresults</span>,
  components <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>,
  color_by <span class='op'>=</span> <span class='cn'>NULL</span>,
  top.n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>mvaresults</span><span class='op'>$</span><span class='va'>loadings</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'>top_lipids</span><span class='op'>(</span><span class='va'>mvaresults</span>, top.n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>LipidomicsExperiment object.</p></td>
    </tr>
    <tr>
      <th>measure</th>
      <td><p>Which measure to use as intensity, usually Area (default).
The measure should be already summarized and normalized.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Either PCA, PCoA, OPLS or OPLS-DA.  Default is <code>PCA</code>.</p></td>
    </tr>
    <tr>
      <th>group_col</th>
      <td><p>Sample annotation to use as grouping column. If not
provided, samples are treated independently.</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>A numeric grouping (OPLS) or two groups to be used for
supervised analysis (OPLS-DA), ignored in other methods.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Extra arguments to be passed to <code>opls()</code> for OPLS-DA,
ignored in other methods.</p></td>
    </tr>
    <tr>
      <th>mvaresults</th>
      <td><p>Results obtained from <code>mva()</code>.</p></td>
    </tr>
    <tr>
      <th>components</th>
      <td><p>Which components to plot. Ignored for PCoA, OPLS and
OPLS-DA results. Default is first 2 components.</p></td>
    </tr>
    <tr>
      <th>color_by</th>
      <td><p>Sample annotation (or lipid annotation in case of
<code>plot_mva_loadings</code>) to use as color. Defaults to individual samples /
lipids</p></td>
    </tr>
    <tr>
      <th>ellipse</th>
      <td><p>Whether to plot ellipses around groups</p></td>
    </tr>
    <tr>
      <th>hotelling</th>
      <td><p>Whether to plot Hotelling T2.</p></td>
    </tr>
    <tr>
      <th>top.n</th>
      <td><p>Number of top ranked features to highlight in the plot.
If omitted, returns top 10 lipids.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Multivariate analysis results in <code>mvaresults</code> object.
The object contains the following:</p><ul>
<li><p>scores    Sample scores</p></li>
<li><p>loadings   Feature or component loadings (not for PCoA)</p></li>
<li><p>method   Multivariate method that was used</p></li>
<li><p>row_data   Lipid molecule annotations</p></li>
<li><p>col_data   Sample annotations</p></li>
<li><p>original_object   Original output object as returned by
corresponding analysis methods</p></li>
</ul>

<p><code>plot_mva</code> returns a ggplot of the sample scores.</p>
<p><code>plot_mva_loadings</code> returns a ggplot of the loadings.</p>
<p><code>top_lipids</code> returns s dataframe of <code>top.n</code> lipids with
their annotations.</p>
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    
<ul>
<li><p><code>plot_mva</code>: plots a multivariate scatterplot of sample scores to investigate
sample clustering.</p></li>
<li><p><code>plot_mva_loadings</code>: Plot a multivariate scatterplot of feature loadings
to investigate feature importance.</p></li>
<li><p><code>top_lipids</code>: extracts top lipids from OPLS-DA results</p></li>
</ul>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>data_normalized</span><span class='op'>)</span>

<span class='co'># PCA</span>
<span class='va'>mvaresults</span> <span class='op'>&lt;-</span> <span class='fu'>mva</span><span class='op'>(</span><span class='va'>data_normalized</span>, measure <span class='op'>=</span> <span class='st'>"Area"</span>, method <span class='op'>=</span> <span class='st'>"PCA"</span><span class='op'>)</span>
<span class='fu'>plot_mva</span><span class='op'>(</span><span class='va'>mvaresults</span>, color_by <span class='op'>=</span> <span class='st'>"group"</span><span class='op'>)</span>
</div><div class='img'><img src='mva-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># NOT RUN</span>
<span class='co'># plot_mva(mvaresults, color_by = "Diet", components = c(2, 3))</span>

<span class='co'># PCoA</span>
<span class='va'>mvaresults</span> <span class='op'>&lt;-</span> <span class='fu'>mva</span><span class='op'>(</span><span class='va'>data_normalized</span>, measure <span class='op'>=</span> <span class='st'>"Area"</span>, method <span class='op'>=</span> <span class='st'>"PCoA"</span><span class='op'>)</span>
<span class='co'># NOT RUN</span>
<span class='co'># plot_mva(mvaresults, color_by = "group")</span>

<span class='co'># OPLS-DA</span>
<span class='va'>mvaresults</span> <span class='op'>&lt;-</span> <span class='fu'>mva</span><span class='op'>(</span>
  <span class='va'>data_normalized</span>,
  method <span class='op'>=</span> <span class='st'>"OPLS-DA"</span>, group_col <span class='op'>=</span> <span class='st'>"Diet"</span>, groups <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"HighFat"</span>, <span class='st'>"Normal"</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='fu'>plot_mva</span><span class='op'>(</span><span class='va'>mvaresults</span>, color_by <span class='op'>=</span> <span class='st'>"group"</span><span class='op'>)</span>
</div><div class='img'><img src='mva-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>plot_mva_loadings</span><span class='op'>(</span><span class='va'>mvaresults</span>, color_by <span class='op'>=</span> <span class='st'>"Class"</span>, top.n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: ggrepel: 3 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span></div><div class='img'><img src='mva-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>top_lipids</span><span class='op'>(</span><span class='va'>mvaresults</span>, top.n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       filename        Molecule Precursor.Mz Precursor.Charge    clean_name
#&gt; 1  F1_data.csv Cer d18:1/C16:0        538.7                1 Cer 18:1/16:0
#&gt; 2  F1_data.csv Cer d18:1/C18:0        566.7                1 Cer 18:1/18:0
#&gt; 3  F1_data.csv    SM 18:1/16:0        703.5                1  SM 18:1/16:0
#&gt; 4  F1_data.csv Cer d18:0/C20:0        596.7                1 Cer 18:0/20:0
#&gt; 5  F1_data.csv Cer d18:1/C22:6        610.7                1 Cer 18:1/22:6
#&gt; 6  F1_data.csv   SM d18:0/16:0        705.6                1  SM 18:0/16:0
#&gt; 7  F2_data.csv      PC(O-34:3)        742.5                1      PCO-34:3
#&gt; 8  F2_data.csv      PC(P-34:2)        742.5                1      PCP-34:2
#&gt; 9  F2_data.csv      PC(P-38:1)        800.6                1      PCP-38:1
#&gt; 10 F2_data.csv      PC(P-36:5)        764.6                1      PCP-36:5
#&gt;    ambig not_matched  istd class_stub chain1 l_1 s_1 chain2 l_2 s_2 chain3 l_3
#&gt; 1  FALSE       FALSE FALSE        Cer   18:1  18   1   16:0  16   0         NA
#&gt; 2  FALSE       FALSE FALSE        Cer   18:1  18   1   18:0  18   0         NA
#&gt; 3  FALSE       FALSE FALSE         SM   18:1  18   1   16:0  16   0         NA
#&gt; 4  FALSE       FALSE FALSE        Cer   18:0  18   0   20:0  20   0         NA
#&gt; 5  FALSE       FALSE FALSE        Cer   18:1  18   1   22:6  22   6         NA
#&gt; 6  FALSE       FALSE FALSE         SM   18:0  18   0   16:0  16   0         NA
#&gt; 7  FALSE       FALSE FALSE        PCO   34:3  34   3         NA  NA         NA
#&gt; 8  FALSE       FALSE FALSE        PCP   34:2  34   2         NA  NA         NA
#&gt; 9  FALSE       FALSE FALSE        PCP   38:1  38   1         NA  NA         NA
#&gt; 10 FALSE       FALSE FALSE        PCP   36:5  36   5         NA  NA         NA
#&gt;    s_3 chain4 l_4 s_4 total_cl total_cs Class molrank
#&gt; 1   NA         NA  NA       34        1   Cer       1
#&gt; 2   NA         NA  NA       36        1   Cer       2
#&gt; 3   NA         NA  NA       34        1    SM       3
#&gt; 4   NA         NA  NA       38        0   Cer       4
#&gt; 5   NA         NA  NA       40        7   Cer       5
#&gt; 6   NA         NA  NA       34        0    SM       6
#&gt; 7   NA         NA  NA       34        3    PC       7
#&gt; 8   NA         NA  NA       34        2    PC       8
#&gt; 9   NA         NA  NA       38        1    PC       9
#&gt; 10  NA         NA  NA       36        5    PC      10</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Ahmed Mohamed, Ahmed Mohamed, Jeffrey Molendijk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


